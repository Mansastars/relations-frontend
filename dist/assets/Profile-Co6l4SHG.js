import{H as j,r as s,I as a,R as w,E as e,T as y,J as N,K as R,a2 as b,Y as z,Z as L}from"./index-Bsv75-ht.js";import{F as H}from"./FreeTrialBanner-DV28Zp4X.js";import{T as k}from"./ToggleSwitch-Bic69g9F.js";import{a as G,b as W,c as q}from"./index-DAjx3f0A.js";import"./index-C10CzagA.js";import{A as U}from"./Avatar-Bc22yP-5.js";import{U as M}from"./user-CeeFEYbI.js";import{E as D,a as A,c as K}from"./checkPasswordStrength-Cr5QtI3r.js";import"./tag-CrSehwd6.js";const{palette:Z}=j(),{augmentColor:Q}=Z,X=t=>Q({color:{main:t}}),B=j({palette:{mainColor:X("#08a5aa")}}),ee=()=>{const t=s.useRef(),n=s.useRef(),[u,m]=s.useState(""),[f,r]=s.useState(""),[p,g]=s.useState(""),[c,o]=s.useState(!0);s.useEffect(()=>{t.current=window.cloudinary,n.current=t.current.createUploadWidget({cloudName:"divbyxxwx",uploadPreset:"o9yoqewt",multiple:!1,maxFiles:1,clientAllowedFormats:["jpg","jpeg","png"],cropping:!0,croppingAspectRatio:1},(x,d)=>{if(x)a.fire({icon:"error",title:"Upload Error",text:"An error occurred while uploading the image. Please try again or contact support."});else if(d&&d.event==="success"){const _=d.info.secure_url;m(_);const v=JSON.parse(localStorage.getItem("user"));v&&(v.profile_picture=_,localStorage.setItem("user",JSON.stringify(v)));try{const S={profile_picture:_};w.patch("users/update_photo",S).then(()=>a.fire({icon:"success",title:"Upload Successful",text:"Your profile image was uploaded successfully"})).catch(P=>{a.fire({icon:"error",title:"Upload Error",text:"An error occurred while uploading the image. Please try again."}),console.error("Error updating profile picture:",P)})}catch(S){a.fire({icon:"error",title:"Upload Error",text:"An error occurred while uploading the image. Please try again."}),console.error("Error in patch request:",S)}}}),w.get("users/single-user").then(x=>{x.data.user&&(x.data.user.profile_picture&&m(x.data.user.profile_picture),r(x.data.user.first_name),g(x.data.user.last_name)),o(!1)}).catch(x=>{console.error("Error fetching profile picture and user details:",x),o(!1)})},[]);const l=()=>{n.current.open()},i=async()=>{if((await a.fire({title:"Are you sure?",text:"Do you really want to delete your profile image?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await w.patch("users/delete_photo"),m("");const d=JSON.parse(localStorage.getItem("user"));d&&(d.profile_picture="",localStorage.setItem("user",JSON.stringify(d))),a.fire({icon:"success",title:"Image Deleted",text:"Your profile image has been deleted successfully."})}catch(d){console.error("Error deleting profile picture:",d),a.fire({icon:"error",title:"Delete Error",text:"An error occurred while deleting the image. Please try again."})}},h=(x,d)=>`${x[0]}${d[0]}`.toUpperCase();return e.jsxs("div",{className:"w-full flex flex-row max-md:flex-col justify-between max-md:justify-center max-md:gap-5 items-center",children:[e.jsx("div",{className:"w-full flex max-md:justify-center",children:c?e.jsx(U,{sx:{width:128,height:128,backgroundColor:"rgba(8,165,170,70%)",fontSize:32},children:e.jsx(M,{size:48})}):u?e.jsx(U,{src:u,alt:"User's image",sx:{width:128,height:128}}):e.jsx(U,{sx:{width:128,height:128,backgroundColor:"rgba(8,165,170,70%)",fontSize:32},children:h(f,p)})}),e.jsxs("div",{className:"flex gap-5 justify-end max-md:justify-center w-full",children:[e.jsx(y,{theme:B,children:e.jsx(N,{variant:"contained",onClick:l,type:"button",color:"mainColor",children:"Upload Image"})}),e.jsx(y,{theme:B,children:e.jsx(N,{variant:"outlined",onClick:i,type:"button",color:"mainColor",children:"Delete Image"})})]})]})},{palette:te}=j(),{augmentColor:se}=te,re=t=>se({color:{main:t}}),ae=j({palette:{mainColor:re("#08a5aa")}}),$=()=>{const{t}=R(),[n,u]=s.useState(null),[m,f]=s.useState(!1),[r,p]=s.useState({first_name:"",last_name:"",phone_number:"",bio:""});s.useEffect(()=>{(async()=>{try{const i=(await w.get("users/single-user")).data.user;u(i),p({first_name:i.first_name||"",last_name:i.last_name||"",phone_number:i.phone_number||"",bio:i.bio||""})}catch(l){a.fire(t("error"),t("errorFetchingDetails"),"error"),console.error("Error fetching user details:",l)}})()},[t]);const g=o=>{if(o&&o.target){const{name:l,value:i}=o.target;p(h=>({...h,[l]:i}))}},c=async o=>{f(!0),o.preventDefault();const l={first_name:r.first_name,last_name:r.last_name,phone_number:r.phone_number,bio:r.bio};try{const i=await w.patch("users/update-profile",l),h=JSON.parse(localStorage.getItem("user"));h&&(h.first_name=r.first_name,h.last_name=r.last_name,h.phone_number=r.phone_number,h.bio=r.bio,localStorage.setItem("user",JSON.stringify(h))),a.fire(t("profileUpdate"),t("profileUpdateSuccess"),"success")}catch(i){a.fire(t("error"),t("errorUpdatingInfo"),"error"),console.log(i)}finally{f(!1)}};return e.jsx("div",{className:" flex flex-col w-full px-3 items-center overflow-y-auto",children:e.jsx("div",{className:"bg-white py-10 px-6 flex flex-col justify-center mt-10 mb-10 rounded-2xl items-start gap-10 w-[75%]",children:e.jsxs("form",{onSubmit:c,className:" w-full",children:[e.jsxs("div",{className:" w-full",children:[e.jsx("h1",{className:" text-dark-blue font-bold text-3xl",children:t("profile")}),e.jsx("p",{className:" text-dark-blue text-base",children:t("updateProfile")})]}),e.jsxs("div",{className:"flex flex-col gap-5 mt-8 w-full",children:[e.jsx("div",{className:" w-full mb-5",children:e.jsx(ee,{})}),e.jsxs("div",{className:"flex max-[768px]:flex-col gap-5 w-full",children:[e.jsx(b,{type:"text",title:t("firstName"),placeholder:"",value:r.first_name,onChange:g}),e.jsx(b,{type:"text",title:t("lastName"),placeholder:"",value:r.last_name,onChange:g})]}),e.jsxs("div",{className:" flex flex-col gap-1 w-1/2 max-[768px]:w-full",children:[e.jsx(b,{type:"tel",title:t("phoneNumber"),placeholder:"+123456789",maxLength:15,value:r.phone_number,onChange:g}),e.jsx("p",{className:" text-dark-blue text-sm",children:t("phoneNumberDescription")})]}),e.jsxs("div",{className:"",children:[e.jsxs("div",{className:" relative col-span-full",children:[e.jsx("label",{htmlFor:"bio",className:" absolute -top-3 left-3 bg-white px-1 text-sm leading-6 text-dark-blue font-semibold",children:t("bio")}),e.jsx("div",{className:"mt-1",children:e.jsx("textarea",{name:"bio",rows:2,className:"block w-full rounded-md border border-dark-blue py-2.5 pl-2 text-dark-blue",placeholder:"",value:r.bio,onChange:g})})]}),e.jsx("p",{className:"text-dark-blue text-sm",children:t("bioDescription")})]})]}),e.jsx("div",{className:" mt-5",children:e.jsx(y,{theme:ae,children:e.jsx(N,{variant:"contained",className:" w-full",color:"mainColor",type:"submit",disabled:m&&!0,children:t("updateProfileButton")})})})]})})})},{palette:le}=j(),{augmentColor:oe}=le,ie=t=>oe({color:{main:t}}),ne=j({palette:{mainColor:ie("#08a5aa")}}),V=()=>{const[t,n]=s.useState(null),[u,m]=s.useState(!1),[f,r]=s.useState({email:""});s.useEffect(()=>{(async()=>{try{const l=(await w.get("users/single-user")).data.user;n(l),r({email:l.email||""})}catch(o){o.response.data.message?a.fire("Error",o.response.data.message,"error"):a.fire("Error","An error occurred while trying to get your information. Please refresh the page.","error"),console.error("Error fetching user details:",o)}})()},[]);const p=c=>{if(c&&c.target){const{name:o,value:l}=c.target;r(i=>({...i,[o]:l}))}},g=async c=>{c.preventDefault();const o={email:f.email};m(!0);try{const l=await w.patch("users/update-email",o),i=JSON.parse(localStorage.getItem("user"));i&&(i.email=f.email,localStorage.setItem("user",JSON.stringify(i))),a.fire("Email Update","Your email was updated successfully","success")}catch(l){l.response.data.message?a.fire("Error",l.response.data.message,"error"):a.fire("Error","An waiting error occurred while updating your information. Please try again.","error"),console.log(l)}finally{m(!1)}};return e.jsx("div",{className:" flex flex-col w-full px-3 items-center overflow-y-auto",children:e.jsx("div",{className:"bg-white py-10 px-6 max-sm:px-3 flex flex-col justify-center mt-10 mb-10 rounded-2xl items-start gap-10 w-[75%] max-md:w-full",children:e.jsxs("form",{onSubmit:g,className:" w-full",children:[e.jsxs("div",{children:[e.jsx("h1",{className:" text-dark-blue font-bold text-3xl",children:"Email"}),e.jsx("p",{className:" text-dark-blue text-base",children:"Use this form to update your email."})]}),e.jsx("div",{className:"flex flex-col gap-5 mt-8",children:e.jsxs("div",{children:[e.jsx(b,{type:"email",title:"Email",placeholder:"",id:"email",value:f.email,onChange:p}),e.jsx("p",{className:"text-dark-blue text-sm",children:"You will need this email to log in."})]})}),e.jsx("div",{className:" mt-5",children:e.jsx(y,{theme:ne,children:e.jsx(N,{variant:"contained",className:" w-full",color:"mainColor",type:"submit",disabled:u&&!0,children:"Update Email"})})})]})})})},{palette:ce}=j(),{augmentColor:ue}=ce,de=t=>ue({color:{main:t}}),me=j({palette:{mainColor:de("#08a5aa")}}),F=()=>{s.useState(null);const[t,n]=s.useState(!1),[u,m]=s.useState(!1),[f,r]=s.useState(!1),[p,g]=s.useState(!1),[c,o]=s.useState({old_password:"",new_password:"",confirm_password:""}),[l,i]=s.useState(0),[h,x]=s.useState(!1),d=E=>{if(E&&E.target){const{name:C,value:J}=E.target;o(O=>({...O,[C]:J}))}const I=K(c.new_password);i(I),x(I>=2)},_=async E=>{E.preventDefault();const I={old_password:c.old_password,new_password:c.new_password,confirm_password:c.confirm_password};g(!0);try{if(h){const C=await w.patch("users/change-password",I);o({old_password:"",new_password:"",confirm_password:""}),a.fire("Password Update","Your password was updated successfully","success")}else a.fire("Error","Password must be at least eight characters long.","error")}catch(C){C.response.data.message?a.fire("Success",`${C.response.data.message}`,"success"):a.fire("Error","An waiting error occurred while updating your information. Please try again.","error"),console.log(C)}finally{g(!1)}},v=()=>{n(!t)},S=()=>{r(!f)},P=()=>{m(!u)};return e.jsx("div",{className:" flex flex-col w-full px-3 items-center overflow-y-auto",children:e.jsx("div",{className:"bg-white py-10 px-6 max-sm:px-3 flex flex-col justify-center mt-10 mb-10 rounded-2xl items-start gap-10 w-[75%] max-md:w-full",children:e.jsxs("form",{onSubmit:_,className:" w-full",children:[e.jsxs("div",{children:[e.jsx("h1",{className:" text-dark-blue font-bold text-3xl",children:"Password"}),e.jsx("p",{className:" text-dark-blue text-base",children:"Use this form to update your password."})]}),e.jsx("div",{className:"flex flex-col gap-5 mt-8",children:e.jsxs("div",{className:" flex flex-col gap-2",children:[e.jsxs("div",{className:" flex flex-col gap-6",children:[e.jsx(b,{type:t?"text":"password",title:"Current Password",placeholder:"",id:"old_password",icon:t?e.jsx(D,{size:14,onClick:v}):e.jsx(A,{size:14,onClick:v}),value:c.old_password,onChange:d}),e.jsxs("div",{children:[e.jsx(b,{type:u?"text":"password",title:"New Password",placeholder:"",id:"new_password",icon:u?e.jsx(D,{size:14,onClick:P}):e.jsx(A,{size:14,onClick:P}),value:c.new_password,onChange:d}),l>0&&e.jsx("p",{className:`text-sm ${l>=2?"text-green-500":"text-red-500"}`,children:l>=2?"Strong password":"Weak password"})]}),e.jsx(b,{type:f?"text":"password",title:"Confirm Password",placeholder:"",id:"confirm_password",icon:f?e.jsx(D,{size:14,onClick:S}):e.jsx(A,{size:14,onClick:S}),value:c.confirm_password,onChange:d})]}),e.jsx("p",{className:"text-dark-blue text-sm",children:"Must be at least 8 characters long."})]})}),e.jsx("div",{className:" mt-5",children:e.jsx(y,{theme:me,children:e.jsx(N,{variant:"contained",className:" w-full",color:"mainColor",type:"submit",disabled:p&&!0,children:"Update Password"})})})]})})})},{palette:fe}=j(),{augmentColor:xe}=fe,pe=t=>xe({color:{main:t}}),T=j({palette:{mainColor:pe("#ff5252")}}),Y=()=>{const[t,n]=s.useState(""),u=z();s.useEffect(()=>{const r=JSON.parse(localStorage.getItem("user"));n(r.role),console.log(r.role)});const m=async()=>{a.fire({title:"Are you sure?",text:"You will not be able to recover your account!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, keep it"}).then(async r=>{if(r.isConfirmed)try{await w.delete("users/delete-account"),a.fire("Deleted!","Your account has been deleted.","success"),u("/auth/sign_up")}catch(p){console.error("Error:",p),a.fire("Error","Failed to delete user","error")}})},f=async()=>{a.fire({title:"Are you sure?",text:"You can also switch back anytime",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"No"}).then(async r=>{if(r.isConfirmed)try{await w.post("company/switch-account-type"),a.fire("","Your account has been successfully switched","success"),u("/auth/login")}catch(p){console.error("Error:",p),a.fire("Error","Failed to delete user","error")}})};return e.jsxs("div",{className:" flex flex-col w-full px-3 items-center overflow-y-auto",children:[e.jsx("div",{className:"bg-white py-10 px-6 max-sm:px-3 flex flex-col justify-center mt-10 mb-10 rounded-2xl items-start gap-10 w-[75%] max-md:w-full",children:e.jsx("div",{className:" w-full ",children:e.jsxs("div",{className:" flex flex-col gap-5 pb-8 max-sm:flex-col",children:[e.jsxs("div",{className:" flex flex-col gap-5",children:[e.jsx("h1",{className:"font-bold text-3xl text-green-500",children:"Switch account type"}),e.jsxs("p",{className:"text-dark-blue text-base font-semibold",children:["By clicking the button below, you are switching your account type to ",t==="Company"?"User":"Company",". Are you sure you want to proceed?"]})]}),e.jsx("div",{className:" mt-5 flex justify-center",children:e.jsx(y,{theme:T,children:e.jsx(N,{variant:"contained",className:" w-[80%] max-md:w-full",color:"success",type:"button",onClick:()=>f(),children:"Switch account"})})})]})})}),e.jsx("div",{className:"bg-white py-10 px-6 max-sm:px-3 flex flex-col justify-center mt-10 mb-10 rounded-2xl items-start gap-10 w-[75%] max-md:w-full",children:e.jsx("div",{className:" w-full ",children:e.jsxs("div",{className:" flex flex-col gap-5 pb-8 max-sm:flex-col",children:[e.jsxs("div",{className:" flex flex-col gap-5",children:[e.jsx("h1",{className:"font-bold text-3xl text-red-500",children:"Delete Account"}),e.jsx("p",{className:"text-dark-blue text-base font-semibold",children:"By clicking the button below, you will permanently delete your account. Are you sure you want to proceed?"})]}),e.jsx("div",{className:" mt-5 flex justify-center",children:e.jsx(y,{theme:T,children:e.jsx(N,{variant:"contained",className:" w-[80%] max-md:w-full",color:"mainColor",type:"button",onClick:()=>m(),children:"Delete Account"})})})]})})})]})},he=()=>{const[t,n]=s.useState("Profile"),u=()=>{switch(t){case"Profile":return e.jsx($,{});case"Email":return e.jsx(V,{});case"Password":return e.jsx(F,{});case"Account":return e.jsx(Y,{});default:return e.jsx($,{})}};return e.jsxs("div",{className:"",children:[e.jsx("div",{className:"hidden sm:block",children:e.jsxs(k,{"aria-label":"Full width tabs",style:"fullWidth",className:"bg-light-grey",children:[e.jsx(k.Item,{active:t==="Profile",title:"Profile",icon:G,onClick:()=>n("Profile"),children:e.jsx($,{})}),e.jsx(k.Item,{active:t==="Email",title:"Email",icon:W,onClick:()=>n("Email"),children:e.jsx(V,{})}),e.jsx(k.Item,{active:t==="Password",title:"Password",icon:q,onClick:()=>n("Password"),children:e.jsx(F,{})}),e.jsx(k.Item,{active:t==="Account",title:"Account",onClick:()=>n("Account"),children:e.jsx(Y,{})})]})}),e.jsxs("div",{className:"block sm:hidden",children:[e.jsxs("select",{value:t,onChange:m=>n(m.target.value),className:"w-full text-lg px-3 py-4 border border-gray-300 active:outline-white",children:[e.jsx("option",{value:"Profile",children:"Profile Settings"}),e.jsx("option",{value:"Email",children:"Email Settings"}),e.jsx("option",{value:"Password",children:"Password Settings"}),e.jsx("option",{value:"Account",children:"Account Settings"})]}),e.jsx("div",{className:"mt-4",children:u()})]})]})};function _e(){const t=z(),{isAuthenticated:n}=L();return s.useEffect(()=>{n||t("/auth/login")},[n,t]),e.jsxs("div",{className:"",children:[e.jsx("div",{className:" sticky top-0 z-50",children:e.jsx(H,{})}),e.jsx(he,{})]})}export{_e as default};
