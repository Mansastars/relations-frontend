import{G as g,r as s,H as a,Q as w,C as e,T as S,I as C,J as O,a1 as b,W as T,Y as R}from"./index-Baxz_w6N.js";import{F as L}from"./FreeTrialBanner-DbB4HYv5.js";import{T as E}from"./ToggleSwitch-BXk_Q-Dd.js";import{a as G,b as H,c as W}from"./index-Der3OsHR.js";import"./index-wEd2zrmP.js";import{A as U}from"./Avatar-BHS12o-m.js";import{U as q}from"./user-B8CF0eBt.js";import{E as D,a as A,c as M}from"./checkPasswordStrength-BAv0_57X.js";import"./tag-DOQnLdMp.js";import"./resolveComponentProps-CzfpCp6f.js";const{palette:Q}=g(),{augmentColor:K}=Q,X=t=>K({color:{main:t}}),V=g({palette:{mainColor:X("#08a5aa")}}),Z=()=>{const t=s.useRef(),n=s.useRef(),[u,m]=s.useState(""),[x,i]=s.useState(""),[j,h]=s.useState(""),[c,l]=s.useState(!0);s.useEffect(()=>{t.current=window.cloudinary,n.current=t.current.createUploadWidget({cloudName:"divbyxxwx",uploadPreset:"o9yoqewt",multiple:!1,maxFiles:1,clientAllowedFormats:["jpg","jpeg","png"],cropping:!0,croppingAspectRatio:1},(f,d)=>{if(f)a.fire({icon:"error",title:"Upload Error",text:"An error occurred while uploading the image. Please try again or contact support."});else if(d&&d.event==="success"){const _=d.info.secure_url;m(_);const y=JSON.parse(localStorage.getItem("user"));y&&(y.profile_picture=_,localStorage.setItem("user",JSON.stringify(y)));try{const v={profile_picture:_};w.patch("users/update_photo",v).then(()=>a.fire({icon:"success",title:"Upload Successful",text:"Your profile image was uploaded successfully"})).catch(k=>{a.fire({icon:"error",title:"Upload Error",text:"An error occurred while uploading the image. Please try again."}),console.error("Error updating profile picture:",k)})}catch(v){a.fire({icon:"error",title:"Upload Error",text:"An error occurred while uploading the image. Please try again."}),console.error("Error in patch request:",v)}}}),w.get("users/single-user").then(f=>{f.data.user&&(f.data.user.profile_picture&&m(f.data.user.profile_picture),i(f.data.user.first_name),h(f.data.user.last_name)),l(!1)}).catch(f=>{console.error("Error fetching profile picture and user details:",f),l(!1)})},[]);const r=()=>{n.current.open()},o=async()=>{if((await a.fire({title:"Are you sure?",text:"Do you really want to delete your profile image?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await w.patch("users/delete_photo"),m("");const d=JSON.parse(localStorage.getItem("user"));d&&(d.profile_picture="",localStorage.setItem("user",JSON.stringify(d))),a.fire({icon:"success",title:"Image Deleted",text:"Your profile image has been deleted successfully."})}catch(d){console.error("Error deleting profile picture:",d),a.fire({icon:"error",title:"Delete Error",text:"An error occurred while deleting the image. Please try again."})}},p=(f,d)=>`${f[0]}${d[0]}`.toUpperCase();return e.jsxs("div",{className:"w-full flex flex-row max-md:flex-col justify-between max-md:justify-center max-md:gap-5 items-center",children:[e.jsx("div",{className:"w-full flex max-md:justify-center",children:c?e.jsx(U,{sx:{width:128,height:128,backgroundColor:"rgba(8,165,170,70%)",fontSize:32},children:e.jsx(q,{size:48})}):u?e.jsx(U,{src:u,alt:"User's image",sx:{width:128,height:128}}):e.jsx(U,{sx:{width:128,height:128,backgroundColor:"rgba(8,165,170,70%)",fontSize:32},children:p(x,j)})}),e.jsxs("div",{className:"flex gap-5 justify-end max-md:justify-center w-full",children:[e.jsx(S,{theme:V,children:e.jsx(C,{variant:"contained",onClick:r,type:"button",color:"mainColor",children:"Upload Image"})}),e.jsx(S,{theme:V,children:e.jsx(C,{variant:"outlined",onClick:o,type:"button",color:"mainColor",children:"Delete Image"})})]})]})},{palette:ee}=g(),{augmentColor:te}=ee,se=t=>te({color:{main:t}}),re=g({palette:{mainColor:se("#08a5aa")}}),$=()=>{const{t}=O(),[n,u]=s.useState(null),[m,x]=s.useState(!1),[i,j]=s.useState({first_name:"",last_name:"",phone_number:"",bio:""});s.useEffect(()=>{(async()=>{try{const o=(await w.get("users/single-user")).data.user;u(o),j({first_name:o.first_name||"",last_name:o.last_name||"",phone_number:o.phone_number||"",bio:o.bio||""})}catch(r){a.fire(t("error"),t("errorFetchingDetails"),"error"),console.error("Error fetching user details:",r)}})()},[t]);const h=l=>{if(l&&l.target){const{name:r,value:o}=l.target;j(p=>({...p,[r]:o}))}},c=async l=>{x(!0),l.preventDefault();const r={first_name:i.first_name,last_name:i.last_name,phone_number:i.phone_number,bio:i.bio};try{const o=await w.patch("users/update-profile",r),p=JSON.parse(localStorage.getItem("user"));p&&(p.first_name=i.first_name,p.last_name=i.last_name,p.phone_number=i.phone_number,p.bio=i.bio,localStorage.setItem("user",JSON.stringify(p))),a.fire(t("profileUpdate"),t("profileUpdateSuccess"),"success")}catch(o){a.fire(t("error"),t("errorUpdatingInfo"),"error"),console.log(o)}finally{x(!1)}};return e.jsx("div",{className:" flex flex-col w-full px-3 items-center overflow-y-auto",children:e.jsx("div",{className:"bg-white py-10 px-6 flex flex-col justify-center mt-10 mb-10 rounded-2xl items-start gap-10 w-[75%]",children:e.jsxs("form",{onSubmit:c,className:" w-full",children:[e.jsxs("div",{className:" w-full",children:[e.jsx("h1",{className:" text-dark-blue font-bold text-3xl",children:t("profile")}),e.jsx("p",{className:" text-dark-blue text-base",children:t("updateProfile")})]}),e.jsxs("div",{className:"flex flex-col gap-5 mt-8 w-full",children:[e.jsx("div",{className:" w-full mb-5",children:e.jsx(Z,{})}),e.jsxs("div",{className:"flex max-[768px]:flex-col gap-5 w-full",children:[e.jsx(b,{type:"text",title:t("firstName"),placeholder:"",value:i.first_name,onChange:h}),e.jsx(b,{type:"text",title:t("lastName"),placeholder:"",value:i.last_name,onChange:h})]}),e.jsxs("div",{className:" flex flex-col gap-1 w-1/2 max-[768px]:w-full",children:[e.jsx(b,{type:"tel",title:t("phoneNumber"),placeholder:"+123456789",maxLength:15,value:i.phone_number,onChange:h}),e.jsx("p",{className:" text-dark-blue text-sm",children:t("phoneNumberDescription")})]}),e.jsxs("div",{className:"",children:[e.jsxs("div",{className:" relative col-span-full",children:[e.jsx("label",{htmlFor:"bio",className:" absolute -top-3 left-3 bg-white px-1 text-sm leading-6 text-dark-blue font-semibold",children:t("bio")}),e.jsx("div",{className:"mt-1",children:e.jsx("textarea",{name:"bio",rows:2,className:"block w-full rounded-md border border-dark-blue py-2.5 pl-2 text-dark-blue",placeholder:"",value:i.bio,onChange:h})})]}),e.jsx("p",{className:"text-dark-blue text-sm",children:t("bioDescription")})]})]}),e.jsx("div",{className:" mt-5",children:e.jsx(S,{theme:re,children:e.jsx(C,{variant:"contained",className:" w-full",color:"mainColor",type:"submit",disabled:m&&!0,children:t("updateProfileButton")})})})]})})})},{palette:ae}=g(),{augmentColor:le}=ae,oe=t=>le({color:{main:t}}),ie=g({palette:{mainColor:oe("#08a5aa")}}),F=()=>{const[t,n]=s.useState(null),[u,m]=s.useState(!1),[x,i]=s.useState({email:""});s.useEffect(()=>{(async()=>{try{const r=(await w.get("users/single-user")).data.user;n(r),i({email:r.email||""})}catch(l){l.response.data.message?a.fire("Error",l.response.data.message,"error"):a.fire("Error","An error occurred while trying to get your information. Please refresh the page.","error"),console.error("Error fetching user details:",l)}})()},[]);const j=c=>{if(c&&c.target){const{name:l,value:r}=c.target;i(o=>({...o,[l]:r}))}},h=async c=>{c.preventDefault();const l={email:x.email};m(!0);try{const r=await w.patch("users/update-email",l),o=JSON.parse(localStorage.getItem("user"));o&&(o.email=x.email,localStorage.setItem("user",JSON.stringify(o))),a.fire("Email Update","Your email was updated successfully","success")}catch(r){r.response.data.message?a.fire("Error",r.response.data.message,"error"):a.fire("Error","An waiting error occurred while updating your information. Please try again.","error"),console.log(r)}finally{m(!1)}};return e.jsx("div",{className:" flex flex-col w-full px-3 items-center overflow-y-auto",children:e.jsx("div",{className:"bg-white py-10 px-6 max-sm:px-3 flex flex-col justify-center mt-10 mb-10 rounded-2xl items-start gap-10 w-[75%] max-md:w-full",children:e.jsxs("form",{onSubmit:h,className:" w-full",children:[e.jsxs("div",{children:[e.jsx("h1",{className:" text-dark-blue font-bold text-3xl",children:"Email"}),e.jsx("p",{className:" text-dark-blue text-base",children:"Use this form to update your email."})]}),e.jsx("div",{className:"flex flex-col gap-5 mt-8",children:e.jsxs("div",{children:[e.jsx(b,{type:"email",title:"Email",placeholder:"",id:"email",value:x.email,onChange:j}),e.jsx("p",{className:"text-dark-blue text-sm",children:"You will need this email to log in."})]})}),e.jsx("div",{className:" mt-5",children:e.jsx(S,{theme:ie,children:e.jsx(C,{variant:"contained",className:" w-full",color:"mainColor",type:"submit",disabled:u&&!0,children:"Update Email"})})})]})})})},{palette:ne}=g(),{augmentColor:ce}=ne,de=t=>ce({color:{main:t}}),ue=g({palette:{mainColor:de("#08a5aa")}}),B=()=>{s.useState(null);const[t,n]=s.useState(!1),[u,m]=s.useState(!1),[x,i]=s.useState(!1),[j,h]=s.useState(!1),[c,l]=s.useState({old_password:"",new_password:"",confirm_password:""}),[r,o]=s.useState(0),[p,f]=s.useState(!1),d=P=>{if(P&&P.target){const{name:N,value:Y}=P.target;l(J=>({...J,[N]:Y}))}const I=M(c.new_password);o(I),f(I>=2)},_=async P=>{P.preventDefault();const I={old_password:c.old_password,new_password:c.new_password,confirm_password:c.confirm_password};h(!0);try{if(p){const N=await w.patch("users/change-password",I);l({old_password:"",new_password:"",confirm_password:""}),a.fire("Password Update","Your password was updated successfully","success")}else a.fire("Error","Password must be at least eight characters long.","error")}catch(N){N.response.data.message?a.fire("Success",`${N.response.data.message}`,"success"):a.fire("Error","An waiting error occurred while updating your information. Please try again.","error"),console.log(N)}finally{h(!1)}},y=()=>{n(!t)},v=()=>{i(!x)},k=()=>{m(!u)};return e.jsx("div",{className:" flex flex-col w-full px-3 items-center overflow-y-auto",children:e.jsx("div",{className:"bg-white py-10 px-6 max-sm:px-3 flex flex-col justify-center mt-10 mb-10 rounded-2xl items-start gap-10 w-[75%] max-md:w-full",children:e.jsxs("form",{onSubmit:_,className:" w-full",children:[e.jsxs("div",{children:[e.jsx("h1",{className:" text-dark-blue font-bold text-3xl",children:"Password"}),e.jsx("p",{className:" text-dark-blue text-base",children:"Use this form to update your password."})]}),e.jsx("div",{className:"flex flex-col gap-5 mt-8",children:e.jsxs("div",{className:" flex flex-col gap-2",children:[e.jsxs("div",{className:" flex flex-col gap-6",children:[e.jsx(b,{type:t?"text":"password",title:"Current Password",placeholder:"",id:"old_password",icon:t?e.jsx(D,{size:14,onClick:y}):e.jsx(A,{size:14,onClick:y}),value:c.old_password,onChange:d}),e.jsxs("div",{children:[e.jsx(b,{type:u?"text":"password",title:"New Password",placeholder:"",id:"new_password",icon:u?e.jsx(D,{size:14,onClick:k}):e.jsx(A,{size:14,onClick:k}),value:c.new_password,onChange:d}),r>0&&e.jsx("p",{className:`text-sm ${r>=2?"text-green-500":"text-red-500"}`,children:r>=2?"Strong password":"Weak password"})]}),e.jsx(b,{type:x?"text":"password",title:"Confirm Password",placeholder:"",id:"confirm_password",icon:x?e.jsx(D,{size:14,onClick:v}):e.jsx(A,{size:14,onClick:v}),value:c.confirm_password,onChange:d})]}),e.jsx("p",{className:"text-dark-blue text-sm",children:"Must be at least 8 characters long."})]})}),e.jsx("div",{className:" mt-5",children:e.jsx(S,{theme:ue,children:e.jsx(C,{variant:"contained",className:" w-full",color:"mainColor",type:"submit",disabled:j&&!0,children:"Update Password"})})})]})})})},{palette:me}=g(),{augmentColor:fe}=me,xe=t=>fe({color:{main:t}}),pe=g({palette:{mainColor:xe("#ff5252")}}),z=()=>{const t=T(),n=async()=>{a.fire({title:"Are you sure?",text:"You will not be able to recover your account!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, keep it"}).then(async u=>{if(u.isConfirmed)try{await w.delete("users/delete-account"),a.fire("Deleted!","Your account has been deleted.","success"),t("/auth/sign_up")}catch(m){console.error("Error:",m),a.fire("Error","Failed to delete user","error")}})};return e.jsx("div",{className:" flex flex-col w-full px-3 items-center overflow-y-auto",children:e.jsx("div",{className:"bg-white py-10 px-6 max-sm:px-3 flex flex-col justify-center mt-10 mb-10 rounded-2xl items-start gap-10 w-[75%] max-md:w-full",children:e.jsx("div",{className:" w-full ",children:e.jsxs("div",{className:" flex flex-col gap-5 pb-8 max-sm:flex-col",children:[e.jsxs("div",{className:" flex flex-col gap-5",children:[e.jsx("h1",{className:"font-bold text-3xl text-red-500",children:"Delete Account"}),e.jsx("p",{className:"text-dark-blue text-base font-semibold",children:"By clicking the button below, you will permanently delete your account. Are you sure you want to proceed?"})]}),e.jsx("div",{className:" mt-5 flex justify-center",children:e.jsx(S,{theme:pe,children:e.jsx(C,{variant:"contained",className:" w-[80%] max-md:w-full",color:"mainColor",type:"button",onClick:()=>n(),children:"Delete Account"})})})]})})})})},he=()=>{const[t,n]=s.useState("Profile"),u=()=>{switch(t){case"Profile":return e.jsx($,{});case"Email":return e.jsx(F,{});case"Password":return e.jsx(B,{});case"Account":return e.jsx(z,{});default:return e.jsx($,{})}};return e.jsxs("div",{className:"",children:[e.jsx("div",{className:"hidden sm:block",children:e.jsxs(E,{"aria-label":"Full width tabs",style:"fullWidth",className:"bg-light-grey",children:[e.jsx(E.Item,{active:t==="Profile",title:"Profile",icon:G,onClick:()=>n("Profile"),children:e.jsx($,{})}),e.jsx(E.Item,{active:t==="Email",title:"Email",icon:H,onClick:()=>n("Email"),children:e.jsx(F,{})}),e.jsx(E.Item,{active:t==="Password",title:"Password",icon:W,onClick:()=>n("Password"),children:e.jsx(B,{})}),e.jsx(E.Item,{active:t==="Account",title:"Account",onClick:()=>n("Account"),children:e.jsx(z,{})})]})}),e.jsxs("div",{className:"block sm:hidden",children:[e.jsxs("select",{value:t,onChange:m=>n(m.target.value),className:"w-full text-lg px-3 py-4 border border-gray-300 active:outline-white",children:[e.jsx("option",{value:"Profile",children:"Profile Settings"}),e.jsx("option",{value:"Email",children:"Email Settings"}),e.jsx("option",{value:"Password",children:"Password Settings"}),e.jsx("option",{value:"Account",children:"Account Settings"})]}),e.jsx("div",{className:"mt-4",children:u()})]})]})},ge=he;function Ee(){const t=T(),{isAuthenticated:n}=R();return s.useEffect(()=>{n||t("/auth/login")},[n,t]),e.jsxs("div",{className:"",children:[e.jsx("div",{className:" sticky top-0 z-50",children:e.jsx(L,{})}),e.jsx(ge,{})]})}export{Ee as default};
