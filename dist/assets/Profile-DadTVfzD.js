import{H as y,r,I as n,R as p,E as e,T as N,J as S,K as H,a2 as v,Y as z,Q as I,Z as M}from"./index-lhLkZ3k6.js";import{F as q}from"./FreeTrialBanner-C424XPjH.js";import{T as _}from"./ToggleSwitch-CRpUR2wp.js";import{a as G,b as W,c as K}from"./index-Bn8KEBkX.js";import"./index-DNeFr8LK.js";import{A as D}from"./Avatar-DCM1zG9i.js";import{U as Q}from"./user-BFv5FJ_C.js";import{E as U,a as $,c as Z}from"./checkPasswordStrength-Bc6ndqV4.js";import"./tag-Clyp-CbM.js";const{palette:X}=y(),{augmentColor:ee}=X,te=t=>ee({color:{main:t}}),T=y({palette:{mainColor:te("#08a5aa")}}),se=()=>{const t=r.useRef(),i=r.useRef(),[x,f]=r.useState(""),[o,a]=r.useState(""),[g,h]=r.useState(""),[m,d]=r.useState(!0);r.useEffect(()=>{t.current=window.cloudinary,i.current=t.current.createUploadWidget({cloudName:"divbyxxwx",uploadPreset:"o9yoqewt",multiple:!1,maxFiles:1,clientAllowedFormats:["jpg","jpeg","png"],cropping:!0,croppingAspectRatio:1},(s,l)=>{if(s)n.fire({icon:"error",title:"Upload Error",text:"An error occurred while uploading the image. Please try again or contact support."});else if(l&&l.event==="success"){const j=l.info.secure_url;f(j);const b=JSON.parse(localStorage.getItem("user"));b&&(b.profile_picture=j,localStorage.setItem("user",JSON.stringify(b)));try{const C={profile_picture:j};p.patch("users/update_photo",C).then(()=>n.fire({icon:"success",title:"Upload Successful",text:"Your profile image was uploaded successfully"})).catch(P=>{n.fire({icon:"error",title:"Upload Error",text:"An error occurred while uploading the image. Please try again."}),console.error("Error updating profile picture:",P)})}catch(C){n.fire({icon:"error",title:"Upload Error",text:"An error occurred while uploading the image. Please try again."}),console.error("Error in patch request:",C)}}}),p.get("users/single-user").then(s=>{s.data.user&&(s.data.user.profile_picture&&f(s.data.user.profile_picture),a(s.data.user.first_name),h(s.data.user.last_name)),d(!1)}).catch(s=>{console.error("Error fetching profile picture and user details:",s),d(!1)})},[]);const c=()=>{i.current.open()},u=async()=>{if((await n.fire({title:"Are you sure?",text:"Do you really want to delete your profile image?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await p.patch("users/delete_photo"),f("");const l=JSON.parse(localStorage.getItem("user"));l&&(l.profile_picture="",localStorage.setItem("user",JSON.stringify(l))),n.fire({icon:"success",title:"Image Deleted",text:"Your profile image has been deleted successfully."})}catch(l){console.error("Error deleting profile picture:",l),n.fire({icon:"error",title:"Delete Error",text:"An error occurred while deleting the image. Please try again."})}},w=(s,l)=>`${s[0]}${l[0]}`.toUpperCase();return e.jsxs("div",{className:"w-full flex flex-row max-md:flex-col justify-between max-md:justify-center max-md:gap-5 items-center",children:[e.jsx("div",{className:"w-full flex max-md:justify-center",children:m?e.jsx(D,{sx:{width:128,height:128,backgroundColor:"rgba(8,165,170,70%)",fontSize:32},children:e.jsx(Q,{size:48})}):x?e.jsx(D,{src:x,alt:"User's image",sx:{width:128,height:128}}):e.jsx(D,{sx:{width:128,height:128,backgroundColor:"rgba(8,165,170,70%)",fontSize:32},children:w(o,g)})}),e.jsxs("div",{className:"flex gap-5 justify-end max-md:justify-center w-full",children:[e.jsx(N,{theme:T,children:e.jsx(S,{variant:"contained",onClick:c,type:"button",color:"mainColor",children:"Upload Image"})}),e.jsx(N,{theme:T,children:e.jsx(S,{variant:"outlined",onClick:u,type:"button",color:"mainColor",children:"Delete Image"})})]})]})},{palette:ae}=y(),{augmentColor:re}=ae,le=t=>re({color:{main:t}}),oe=y({palette:{mainColor:le("#08a5aa")}}),V=()=>{const{t}=H(),[i,x]=r.useState(null),[f,o]=r.useState(!1),[a,g]=r.useState({first_name:"",last_name:"",phone_number:"",bio:""});r.useEffect(()=>{(async()=>{try{const u=(await p.get("users/single-user")).data.user;x(u),g({first_name:u.first_name||"",last_name:u.last_name||"",phone_number:u.phone_number||"",bio:u.bio||""})}catch(c){n.fire(t("error"),t("errorFetchingDetails"),"error"),console.error("Error fetching user details:",c)}})()},[t]);const h=d=>{if(d&&d.target){const{name:c,value:u}=d.target;g(w=>({...w,[c]:u}))}},m=async d=>{o(!0),d.preventDefault();const c={first_name:a.first_name,last_name:a.last_name,phone_number:a.phone_number,bio:a.bio};try{const u=await p.patch("users/update-profile",c),w=JSON.parse(localStorage.getItem("user"));w&&(w.first_name=a.first_name,w.last_name=a.last_name,w.phone_number=a.phone_number,w.bio=a.bio,localStorage.setItem("user",JSON.stringify(w))),n.fire(t("profileUpdate"),t("profileUpdateSuccess"),"success")}catch(u){n.fire(t("error"),t("errorUpdatingInfo"),"error"),console.log(u)}finally{o(!1)}};return e.jsx("div",{className:" flex flex-col w-full px-3 items-center overflow-y-auto",children:e.jsx("div",{className:"bg-white py-10 px-6 flex flex-col justify-center mt-10 mb-10 rounded-2xl items-start gap-10 w-[75%]",children:e.jsxs("form",{onSubmit:m,className:" w-full",children:[e.jsxs("div",{className:" w-full",children:[e.jsx("h1",{className:" text-dark-blue font-bold text-3xl",children:t("profile")}),e.jsx("p",{className:" text-dark-blue text-base",children:t("updateProfile")})]}),e.jsxs("div",{className:"flex flex-col gap-5 mt-8 w-full",children:[e.jsx("div",{className:" w-full mb-5",children:e.jsx(se,{})}),e.jsxs("div",{className:"flex max-[768px]:flex-col gap-5 w-full",children:[e.jsx(v,{type:"text",title:t("firstName"),placeholder:"",value:a.first_name,onChange:h}),e.jsx(v,{type:"text",title:t("lastName"),placeholder:"",value:a.last_name,onChange:h})]}),e.jsxs("div",{className:" flex flex-col gap-1 w-1/2 max-[768px]:w-full",children:[e.jsx(v,{type:"tel",title:t("phoneNumber"),placeholder:"+123456789",maxLength:15,value:a.phone_number,onChange:h}),e.jsx("p",{className:" text-dark-blue text-sm",children:t("phoneNumberDescription")})]}),e.jsxs("div",{className:"",children:[e.jsxs("div",{className:" relative col-span-full",children:[e.jsx("label",{htmlFor:"bio",className:" absolute -top-3 left-3 bg-white px-1 text-sm leading-6 text-dark-blue font-semibold",children:t("bio")}),e.jsx("div",{className:"mt-1",children:e.jsx("textarea",{name:"bio",rows:2,className:"block w-full rounded-md border border-dark-blue py-2.5 pl-2 text-dark-blue",placeholder:"",value:a.bio,onChange:h})})]}),e.jsx("p",{className:"text-dark-blue text-sm",children:t("bioDescription")})]})]}),e.jsx("div",{className:" mt-5",children:e.jsx(N,{theme:oe,children:e.jsx(S,{variant:"contained",className:" w-full",color:"mainColor",type:"submit",disabled:f&&!0,children:t("updateProfileButton")})})})]})})})},{palette:ne}=y(),{augmentColor:ie}=ne,ce=t=>ie({color:{main:t}}),de=y({palette:{mainColor:ce("#08a5aa")}}),B=()=>{const[t,i]=r.useState(null),[x,f]=r.useState(!1),[o,a]=r.useState({email:""});r.useEffect(()=>{(async()=>{try{const c=(await p.get("users/single-user")).data.user;i(c),a({email:c.email||""})}catch(d){d.response.data.message?n.fire("Error",d.response.data.message,"error"):n.fire("Error","An error occurred while trying to get your information. Please refresh the page.","error"),console.error("Error fetching user details:",d)}})()},[]);const g=m=>{if(m&&m.target){const{name:d,value:c}=m.target;a(u=>({...u,[d]:c}))}},h=async m=>{m.preventDefault();const d={email:o.email};f(!0);try{const c=await p.patch("users/update-email",d),u=JSON.parse(localStorage.getItem("user"));u&&(u.email=o.email,localStorage.setItem("user",JSON.stringify(u))),n.fire("Email Update","Your email was updated successfully","success")}catch(c){c.response.data.message?n.fire("Error",c.response.data.message,"error"):n.fire("Error","An waiting error occurred while updating your information. Please try again.","error"),console.log(c)}finally{f(!1)}};return e.jsx("div",{className:" flex flex-col w-full px-3 items-center overflow-y-auto",children:e.jsx("div",{className:"bg-white py-10 px-6 max-sm:px-3 flex flex-col justify-center mt-10 mb-10 rounded-2xl items-start gap-10 w-[75%] max-md:w-full",children:e.jsxs("form",{onSubmit:h,className:" w-full",children:[e.jsxs("div",{children:[e.jsx("h1",{className:" text-dark-blue font-bold text-3xl",children:"Email"}),e.jsx("p",{className:" text-dark-blue text-base",children:"Use this form to update your email."})]}),e.jsx("div",{className:"flex flex-col gap-5 mt-8",children:e.jsxs("div",{children:[e.jsx(v,{type:"email",title:"Email",placeholder:"",id:"email",value:o.email,onChange:g}),e.jsx("p",{className:"text-dark-blue text-sm",children:"You will need this email to log in."})]})}),e.jsx("div",{className:" mt-5",children:e.jsx(N,{theme:de,children:e.jsx(S,{variant:"contained",className:" w-full",color:"mainColor",type:"submit",disabled:x&&!0,children:"Update Email"})})})]})})})},{palette:ue}=y(),{augmentColor:me}=ue,fe=t=>me({color:{main:t}}),xe=y({palette:{mainColor:fe("#08a5aa")}}),F=()=>{r.useState(null);const[t,i]=r.useState(!1),[x,f]=r.useState(!1),[o,a]=r.useState(!1),[g,h]=r.useState(!1),[m,d]=r.useState({old_password:"",new_password:"",confirm_password:""}),[c,u]=r.useState(0),[w,s]=r.useState(!1),l=k=>{if(k&&k.target){const{name:E,value:L}=k.target;d(R=>({...R,[E]:L}))}const A=Z(m.new_password);u(A),s(A>=2)},j=async k=>{k.preventDefault();const A={old_password:m.old_password,new_password:m.new_password,confirm_password:m.confirm_password};h(!0);try{if(w){const E=await p.patch("users/change-password",A);d({old_password:"",new_password:"",confirm_password:""}),n.fire("Password Update","Your password was updated successfully","success")}else n.fire("Error","Password must be at least eight characters long.","error")}catch(E){E.response.data.message?n.fire("Success",`${E.response.data.message}`,"success"):n.fire("Error","An waiting error occurred while updating your information. Please try again.","error"),console.log(E)}finally{h(!1)}},b=()=>{i(!t)},C=()=>{a(!o)},P=()=>{f(!x)};return e.jsx("div",{className:" flex flex-col w-full px-3 items-center overflow-y-auto",children:e.jsx("div",{className:"bg-white py-10 px-6 max-sm:px-3 flex flex-col justify-center mt-10 mb-10 rounded-2xl items-start gap-10 w-[75%] max-md:w-full",children:e.jsxs("form",{onSubmit:j,className:" w-full",children:[e.jsxs("div",{children:[e.jsx("h1",{className:" text-dark-blue font-bold text-3xl",children:"Password"}),e.jsx("p",{className:" text-dark-blue text-base",children:"Use this form to update your password."})]}),e.jsx("div",{className:"flex flex-col gap-5 mt-8",children:e.jsxs("div",{className:" flex flex-col gap-2",children:[e.jsxs("div",{className:" flex flex-col gap-6",children:[e.jsx(v,{type:t?"text":"password",title:"Current Password",placeholder:"",id:"old_password",icon:t?e.jsx(U,{size:14,onClick:b}):e.jsx($,{size:14,onClick:b}),value:m.old_password,onChange:l}),e.jsxs("div",{children:[e.jsx(v,{type:x?"text":"password",title:"New Password",placeholder:"",id:"new_password",icon:x?e.jsx(U,{size:14,onClick:P}):e.jsx($,{size:14,onClick:P}),value:m.new_password,onChange:l}),c>0&&e.jsx("p",{className:`text-sm ${c>=2?"text-green-500":"text-red-500"}`,children:c>=2?"Strong password":"Weak password"})]}),e.jsx(v,{type:o?"text":"password",title:"Confirm Password",placeholder:"",id:"confirm_password",icon:o?e.jsx(U,{size:14,onClick:C}):e.jsx($,{size:14,onClick:C}),value:m.confirm_password,onChange:l})]}),e.jsx("p",{className:"text-dark-blue text-sm",children:"Must be at least 8 characters long."})]})}),e.jsx("div",{className:" mt-5",children:e.jsx(N,{theme:xe,children:e.jsx(S,{variant:"contained",className:" w-full",color:"mainColor",type:"submit",disabled:g&&!0,children:"Update Password"})})})]})})})},{palette:pe}=y(),{augmentColor:he}=pe,ge=t=>he({color:{main:t}}),O=y({palette:{mainColor:ge("#ff5252")}}),Y=()=>{const t=z(),[i,x]=r.useState("");r.useEffect(()=>{const a=JSON.parse(localStorage.getItem("user"));x(a.role),console.log(a.role)});const f=async()=>{n.fire({title:"Are you sure?",text:"You will not be able to recover your account!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, keep it"}).then(async a=>{if(a.isConfirmed)try{await p.delete("users/delete-account"),n.fire("Deleted!","Your account has been deleted.","success"),t("/auth/sign_up")}catch(g){console.error("Error:",g),n.fire("Error","Failed to delete user","error")}})},o=async()=>{n.fire({title:"Are you sure?",text:"You can also switch back anytime",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes",cancelButtonText:"No"}).then(async a=>{if(a.isConfirmed)try{await p.post("company/switch-account-type"),n.fire("","Your account has been successfully switched","success"),t("/auth/login")}catch(g){console.error("Error:",g),n.fire("Error","Failed to switch account","error")}})};return e.jsxs("div",{className:" flex flex-col w-full px-3 items-center overflow-y-auto",children:[e.jsx("div",{className:"bg-white py-10 px-6 max-sm:px-3 flex flex-col justify-center mt-10 mb-10 rounded-2xl items-start gap-10 w-[75%] max-md:w-full",children:e.jsx("div",{className:" w-full ",children:e.jsxs("div",{className:" flex flex-col gap-5 pb-8 max-sm:flex-col",children:[e.jsxs("div",{className:" flex flex-col gap-5",children:[e.jsx("h1",{className:"font-bold text-3xl text-green-500",children:"Switch account type"}),e.jsxs("p",{className:"text-dark-blue text-base font-semibold",children:["By clicking the button below, you are switching your account type to ",i==="Company"?"User":"Company",". Are you sure you want to proceed?"]})]}),e.jsx("div",{className:" mt-5 flex justify-center",children:e.jsx(N,{theme:O,children:e.jsx(S,{variant:"contained",className:" w-[80%] max-md:w-full",color:"success",type:"button",onClick:()=>o(),children:"Switch account"})})})]})})}),e.jsx("div",{className:"bg-white py-10 px-6 max-sm:px-3 flex flex-col justify-center mt-10 mb-10 rounded-2xl items-start gap-10 w-[75%] max-md:w-full",children:e.jsx("div",{className:" w-full ",children:e.jsxs("div",{className:" flex flex-col gap-5 pb-8 max-sm:flex-col",children:[e.jsxs("div",{className:" flex flex-col gap-5",children:[e.jsx("h1",{className:"font-bold text-3xl text-red-500",children:"Delete Account"}),e.jsx("p",{className:"text-dark-blue text-base font-semibold",children:"By clicking the button below, you will permanently delete your account. Are you sure you want to proceed?"})]}),e.jsx("div",{className:" mt-5 flex justify-center",children:e.jsx(N,{theme:O,children:e.jsx(S,{variant:"contained",className:" w-[80%] max-md:w-full",color:"mainColor",type:"button",onClick:()=>f(),children:"Delete Account"})})})]})})})]})},J=()=>{const[t,i]=r.useState([]),[x,f]=r.useState(null),[o,a]=r.useState({email:"",permission:""}),[g,h]=r.useState(!1);r.useEffect(()=>{(async()=>{try{const l=await p.get("company/all-staffs");i(l.data.data)}catch(l){console.error("Error fetching staff list:",l)}})()},[]);const m=async s=>{try{console.log(s);const l=await p.delete(`company/delete-staff/${s}`);console.log(l),i(j=>j.filter(b=>b.id!==s))}catch(l){console.error("Error deleting staff:",l)}},d=s=>{f(s),a({email:s.email,permission:s.permission}),h(!0)},c=()=>{h(!1),a({email:"",permission:""})},u=async s=>{s.preventDefault();try{const l={...o,id:x.id},j=await p.put("company/update-staff",l);console.log("Staff updated successfully:",j.data);const b=await p.get("company/all-staffs");i(b.data.data),f(null),a({email:"",permission:""}),h(!1)}catch(l){console.error("Error updating staff:",l)}},w=async s=>{s.preventDefault();try{const l=await p.post("company/add-staff",o);console.log("Staff added successfully:",l.data);const j=await p.get("company/all-staffs");i(j.data.data),a({email:"",permission:""})}catch(l){console.error("Error adding staff:",l)}};return e.jsxs("div",{className:"flex flex-col w-full px-3 items-center overflow-y-auto",children:[e.jsxs("div",{className:"bg-white py-10 px-6 max-sm:px-3 flex flex-col justify-center mt-10 mb-10 rounded-2xl items-start gap-10 w-[75%] max-md:w-full",children:[e.jsxs("div",{className:"w-full",children:[e.jsx("h1",{className:"font-bold text-3xl",children:"Add Staff"}),e.jsxs("form",{onSubmit:w,children:[e.jsxs("div",{className:"flex gap-2 mb-2 mt-5",children:[e.jsx(v,{type:"text",title:"Staff Email",placeholder:"Enter staff email",name:"email",value:o.email,onChange:s=>a({...o,email:s.target.value})}),e.jsxs("select",{className:"rounded-md border py-2.5 pl-2 text-dark-blue shadow-sm placeholder:text-gray-400 focus:outline-none focus:border focus:border-mansa-blue sm:text-sm sm:leading-6 hover:border-mansa-blue",name:"permission",value:o.permission,required:!0,onChange:s=>a({...o,permission:s.target.value}),children:[e.jsx("option",{value:"",children:"Select permission"}),e.jsx("option",{value:"Viewer",children:"Viewer"}),e.jsx("option",{value:"Editor",children:"Editor"})]})]}),e.jsx(I,{text:"Add Staff",type:"submit"})]})]}),e.jsx("h2",{className:"font-bold text-3xl mt-5",children:"All Staffs"}),e.jsxs("table",{className:"w-full border-collapse border border-gray-300 text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Email"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Permission"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Actions"})]})}),e.jsx("tbody",{children:t.map(s=>e.jsxs("tr",{className:"hover:bg-gray-100",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.email}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:s.permission}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>d(s),className:"bg-blue-500 text-white px-3 py-1 rounded",children:"Edit"}),e.jsx("button",{onClick:()=>m(s.id),className:"bg-red-500 text-white px-3 py-1 rounded",children:"Delete"})]})})]},s.id))})]})]}),g&&e.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-gray-800 bg-opacity-50 flex justify-center items-center",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-96",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Edit Staff"}),e.jsxs("form",{onSubmit:u,children:[e.jsx(v,{type:"text",title:"Email",value:o.email,onChange:s=>a({...o,email:s.target.value})}),e.jsxs("select",{className:"w-full mt-3 mb-4 rounded-md border py-2.5 pl-2",name:"permission",value:o.permission,onChange:s=>a({...o,permission:s.target.value}),children:[e.jsx("option",{value:"",children:"Select permission"}),e.jsx("option",{value:"Viewer",children:"Viewer"}),e.jsx("option",{value:"Editor",children:"Editor"})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(I,{text:"Cancel",onClick:c}),e.jsx(I,{text:"Save",type:"submit"})]})]})]})})]})},we=()=>{const[t,i]=r.useState("Profile"),[x,f]=r.useState("");r.useEffect(()=>{const a=JSON.parse(localStorage.getItem("user"));f(a.role),console.log(a.role)});const o=()=>{switch(t){case"Profile":return e.jsx(V,{});case"Email":return e.jsx(B,{});case"Password":return e.jsx(F,{});case"Account":return e.jsx(Y,{});case"Admin":return e.jsx(J,{});default:return e.jsx(V,{})}};return e.jsxs("div",{className:"",children:[e.jsx("div",{className:"hidden sm:block",children:e.jsxs(_,{"aria-label":"Full width tabs",style:"fullWidth",className:"bg-light-grey",children:[e.jsx(_.Item,{active:t==="Profile",title:"Profile",icon:G,onClick:()=>i("Profile"),children:e.jsx(V,{})}),e.jsx(_.Item,{active:t==="Email",title:"Email",icon:W,onClick:()=>i("Email"),children:e.jsx(B,{})}),e.jsx(_.Item,{active:t==="Password",title:"Password",icon:K,onClick:()=>i("Password"),children:e.jsx(F,{})}),x==="Company"?e.jsx(_.Item,{active:t==="Admin",title:"Admin",onClick:()=>i("Admin"),children:e.jsx(J,{})}):null,e.jsx(_.Item,{active:t==="Account",title:"Account",onClick:()=>i("Account"),children:e.jsx(Y,{})})]})}),e.jsxs("div",{className:"block sm:hidden",children:[e.jsxs("select",{value:t,onChange:a=>i(a.target.value),className:"w-full text-lg px-3 py-4 border border-gray-300 active:outline-white",children:[e.jsx("option",{value:"Profile",children:"Profile Settings"}),e.jsx("option",{value:"Email",children:"Email Settings"}),e.jsx("option",{value:"Password",children:"Password Settings"}),e.jsx("option",{value:"Account",children:"Account Settings"})]}),e.jsx("div",{className:"mt-4",children:o()})]})]})};function ke(){const t=z(),{isAuthenticated:i}=M();return r.useEffect(()=>{i||t("/auth/login")},[i,t]),e.jsxs("div",{className:"",children:[e.jsx("div",{className:" sticky top-0 z-50",children:e.jsx(q,{})}),e.jsx(we,{})]})}export{ke as default};
