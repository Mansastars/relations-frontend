import{H as y,r,I as c,R as p,E as e,T as N,J as S,K as H,a2 as v,Y as z,Q as I,Z as M}from"./index-Lduw5lzM.js";import{F as q}from"./FreeTrialBanner-D0L-V-6C.js";import{T as _}from"./ToggleSwitch-CVwfzEYW.js";import{a as G,b as W,c as K}from"./index-DnMBLQVU.js";import"./index-DMX2lJR_.js";import{A as D}from"./Avatar-DLzbDXZt.js";import{U as Q}from"./user-B2GHpnAL.js";import{E as U,a as $,c as Z}from"./checkPasswordStrength-DpnEnzEn.js";import"./tag-jzT9QzHU.js";const{palette:X}=y(),{augmentColor:ee}=X,te=t=>ee({color:{main:t}}),T=y({palette:{mainColor:te("#08a5aa")}}),se=()=>{const t=r.useRef(),n=r.useRef(),[x,f]=r.useState(""),[o,s]=r.useState(""),[w,h]=r.useState(""),[m,d]=r.useState(!0);r.useEffect(()=>{t.current=window.cloudinary,n.current=t.current.createUploadWidget({cloudName:"divbyxxwx",uploadPreset:"o9yoqewt",multiple:!1,maxFiles:1,clientAllowedFormats:["jpg","jpeg","png"],cropping:!0,croppingAspectRatio:1},(a,l)=>{if(a)c.fire({icon:"error",title:"Upload Error",text:"An error occurred while uploading the image. Please try again or contact support."});else if(l&&l.event==="success"){const j=l.info.secure_url;f(j);const b=JSON.parse(localStorage.getItem("user"));b&&(b.profile_picture=j,localStorage.setItem("user",JSON.stringify(b)));try{const C={profile_picture:j};p.patch("users/update_photo",C).then(()=>c.fire({icon:"success",title:"Upload Successful",text:"Your profile image was uploaded successfully"})).catch(P=>{c.fire({icon:"error",title:"Upload Error",text:"An error occurred while uploading the image. Please try again."}),console.error("Error updating profile picture:",P)})}catch(C){c.fire({icon:"error",title:"Upload Error",text:"An error occurred while uploading the image. Please try again."}),console.error("Error in patch request:",C)}}}),p.get("users/single-user").then(a=>{a.data.user&&(a.data.user.profile_picture&&f(a.data.user.profile_picture),s(a.data.user.first_name),h(a.data.user.last_name)),d(!1)}).catch(a=>{console.error("Error fetching profile picture and user details:",a),d(!1)})},[]);const i=()=>{n.current.open()},u=async()=>{if((await c.fire({title:"Are you sure?",text:"Do you really want to delete your profile image?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"})).isConfirmed)try{await p.patch("users/delete_photo"),f("");const l=JSON.parse(localStorage.getItem("user"));l&&(l.profile_picture="",localStorage.setItem("user",JSON.stringify(l))),c.fire({icon:"success",title:"Image Deleted",text:"Your profile image has been deleted successfully."})}catch(l){console.error("Error deleting profile picture:",l),c.fire({icon:"error",title:"Delete Error",text:"An error occurred while deleting the image. Please try again."})}},g=(a,l)=>`${a[0]}${l[0]}`.toUpperCase();return e.jsxs("div",{className:"w-full flex flex-row max-md:flex-col justify-between max-md:justify-center max-md:gap-5 items-center",children:[e.jsx("div",{className:"w-full flex max-md:justify-center",children:m?e.jsx(D,{sx:{width:128,height:128,backgroundColor:"rgba(8,165,170,70%)",fontSize:32},children:e.jsx(Q,{size:48})}):x?e.jsx(D,{src:x,alt:"User's image",sx:{width:128,height:128}}):e.jsx(D,{sx:{width:128,height:128,backgroundColor:"rgba(8,165,170,70%)",fontSize:32},children:g(o,w)})}),e.jsxs("div",{className:"flex gap-5 justify-end max-md:justify-center w-full",children:[e.jsx(N,{theme:T,children:e.jsx(S,{variant:"contained",onClick:i,type:"button",color:"mainColor",children:"Upload Image"})}),e.jsx(N,{theme:T,children:e.jsx(S,{variant:"outlined",onClick:u,type:"button",color:"mainColor",children:"Delete Image"})})]})]})},{palette:ae}=y(),{augmentColor:re}=ae,le=t=>re({color:{main:t}}),oe=y({palette:{mainColor:le("#08a5aa")}}),V=()=>{const{t}=H(),[n,x]=r.useState(null),[f,o]=r.useState(!1),[s,w]=r.useState({first_name:"",last_name:"",phone_number:"",bio:""});r.useEffect(()=>{(async()=>{try{const u=(await p.get("users/single-user")).data.user;x(u),w({first_name:u.first_name||"",last_name:u.last_name||"",phone_number:u.phone_number||"",bio:u.bio||""})}catch(i){c.fire(t("error"),t("errorFetchingDetails"),"error"),console.error("Error fetching user details:",i)}})()},[t]);const h=d=>{if(d&&d.target){const{name:i,value:u}=d.target;w(g=>({...g,[i]:u}))}},m=async d=>{o(!0),d.preventDefault();const i={first_name:s.first_name,last_name:s.last_name,phone_number:s.phone_number,bio:s.bio};try{const u=await p.patch("users/update-profile",i),g=JSON.parse(localStorage.getItem("user"));g&&(g.first_name=s.first_name,g.last_name=s.last_name,g.phone_number=s.phone_number,g.bio=s.bio,localStorage.setItem("user",JSON.stringify(g))),c.fire(t("profileUpdate"),t("profileUpdateSuccess"),"success")}catch(u){c.fire(t("error"),t("errorUpdatingInfo"),"error"),console.log(u)}finally{o(!1)}};return e.jsx("div",{className:" flex flex-col w-full px-3 items-center overflow-y-auto",children:e.jsx("div",{className:"bg-white py-10 px-6 flex flex-col justify-center mt-10 mb-10 rounded-2xl items-start gap-10 w-[75%]",children:e.jsxs("form",{onSubmit:m,className:" w-full",children:[e.jsxs("div",{className:" w-full",children:[e.jsx("h1",{className:" text-dark-blue font-bold text-3xl",children:t("profile")}),e.jsx("p",{className:" text-dark-blue text-base",children:t("updateProfile")})]}),e.jsxs("div",{className:"flex flex-col gap-5 mt-8 w-full",children:[e.jsx("div",{className:" w-full mb-5",children:e.jsx(se,{})}),e.jsxs("div",{className:"flex max-[768px]:flex-col gap-5 w-full",children:[e.jsx(v,{type:"text",title:t("firstName"),placeholder:"",value:s.first_name,onChange:h}),e.jsx(v,{type:"text",title:t("lastName"),placeholder:"",value:s.last_name,onChange:h})]}),e.jsxs("div",{className:" flex flex-col gap-1 w-1/2 max-[768px]:w-full",children:[e.jsx(v,{type:"tel",title:t("phoneNumber"),placeholder:"+123456789",maxLength:15,value:s.phone_number,onChange:h}),e.jsx("p",{className:" text-dark-blue text-sm",children:t("phoneNumberDescription")})]}),e.jsxs("div",{className:"",children:[e.jsxs("div",{className:" relative col-span-full",children:[e.jsx("label",{htmlFor:"bio",className:" absolute -top-3 left-3 bg-white px-1 text-sm leading-6 text-dark-blue font-semibold",children:t("bio")}),e.jsx("div",{className:"mt-1",children:e.jsx("textarea",{name:"bio",rows:2,className:"block w-full rounded-md border border-dark-blue py-2.5 pl-2 text-dark-blue",placeholder:"",value:s.bio,onChange:h})})]}),e.jsx("p",{className:"text-dark-blue text-sm",children:t("bioDescription")})]})]}),e.jsx("div",{className:" mt-5",children:e.jsx(N,{theme:oe,children:e.jsx(S,{variant:"contained",className:" w-full",color:"mainColor",type:"submit",disabled:f&&!0,children:t("updateProfileButton")})})})]})})})},{palette:ne}=y(),{augmentColor:ie}=ne,ce=t=>ie({color:{main:t}}),de=y({palette:{mainColor:ce("#08a5aa")}}),F=()=>{const[t,n]=r.useState(null),[x,f]=r.useState(!1),[o,s]=r.useState({email:""});r.useEffect(()=>{(async()=>{try{const i=(await p.get("users/single-user")).data.user;n(i),s({email:i.email||""})}catch(d){d.response.data.message?c.fire("Error",d.response.data.message,"error"):c.fire("Error","An error occurred while trying to get your information. Please refresh the page.","error"),console.error("Error fetching user details:",d)}})()},[]);const w=m=>{if(m&&m.target){const{name:d,value:i}=m.target;s(u=>({...u,[d]:i}))}},h=async m=>{m.preventDefault();const d={email:o.email};f(!0);try{const i=await p.patch("users/update-email",d),u=JSON.parse(localStorage.getItem("user"));u&&(u.email=o.email,localStorage.setItem("user",JSON.stringify(u))),c.fire("Email Update","Your email was updated successfully","success")}catch(i){i.response.data.message?c.fire("Error",i.response.data.message,"error"):c.fire("Error","An waiting error occurred while updating your information. Please try again.","error"),console.log(i)}finally{f(!1)}};return e.jsx("div",{className:" flex flex-col w-full px-3 items-center overflow-y-auto",children:e.jsx("div",{className:"bg-white py-10 px-6 max-sm:px-3 flex flex-col justify-center mt-10 mb-10 rounded-2xl items-start gap-10 w-[75%] max-md:w-full",children:e.jsxs("form",{onSubmit:h,className:" w-full",children:[e.jsxs("div",{children:[e.jsx("h1",{className:" text-dark-blue font-bold text-3xl",children:"Email"}),e.jsx("p",{className:" text-dark-blue text-base",children:"Use this form to update your email."})]}),e.jsx("div",{className:"flex flex-col gap-5 mt-8",children:e.jsxs("div",{children:[e.jsx(v,{type:"email",title:"Email",placeholder:"",id:"email",value:o.email,onChange:w}),e.jsx("p",{className:"text-dark-blue text-sm",children:"You will need this email to log in."})]})}),e.jsx("div",{className:" mt-5",children:e.jsx(N,{theme:de,children:e.jsx(S,{variant:"contained",className:" w-full",color:"mainColor",type:"submit",disabled:x&&!0,children:"Update Email"})})})]})})})},{palette:ue}=y(),{augmentColor:me}=ue,fe=t=>me({color:{main:t}}),xe=y({palette:{mainColor:fe("#08a5aa")}}),B=()=>{r.useState(null);const[t,n]=r.useState(!1),[x,f]=r.useState(!1),[o,s]=r.useState(!1),[w,h]=r.useState(!1),[m,d]=r.useState({old_password:"",new_password:"",confirm_password:""}),[i,u]=r.useState(0),[g,a]=r.useState(!1),l=k=>{if(k&&k.target){const{name:E,value:L}=k.target;d(R=>({...R,[E]:L}))}const A=Z(m.new_password);u(A),a(A>=2)},j=async k=>{k.preventDefault();const A={old_password:m.old_password,new_password:m.new_password,confirm_password:m.confirm_password};h(!0);try{if(g){const E=await p.patch("users/change-password",A);d({old_password:"",new_password:"",confirm_password:""}),c.fire("Password Update","Your password was updated successfully","success")}else c.fire("Error","Password must be at least eight characters long.","error")}catch(E){E.response.data.message?c.fire("Success",`${E.response.data.message}`,"success"):c.fire("Error","An waiting error occurred while updating your information. Please try again.","error"),console.log(E)}finally{h(!1)}},b=()=>{n(!t)},C=()=>{s(!o)},P=()=>{f(!x)};return e.jsx("div",{className:" flex flex-col w-full px-3 items-center overflow-y-auto",children:e.jsx("div",{className:"bg-white py-10 px-6 max-sm:px-3 flex flex-col justify-center mt-10 mb-10 rounded-2xl items-start gap-10 w-[75%] max-md:w-full",children:e.jsxs("form",{onSubmit:j,className:" w-full",children:[e.jsxs("div",{children:[e.jsx("h1",{className:" text-dark-blue font-bold text-3xl",children:"Password"}),e.jsx("p",{className:" text-dark-blue text-base",children:"Use this form to update your password."})]}),e.jsx("div",{className:"flex flex-col gap-5 mt-8",children:e.jsxs("div",{className:" flex flex-col gap-2",children:[e.jsxs("div",{className:" flex flex-col gap-6",children:[e.jsx(v,{type:t?"text":"password",title:"Current Password",placeholder:"",id:"old_password",icon:t?e.jsx(U,{size:14,onClick:b}):e.jsx($,{size:14,onClick:b}),value:m.old_password,onChange:l}),e.jsxs("div",{children:[e.jsx(v,{type:x?"text":"password",title:"New Password",placeholder:"",id:"new_password",icon:x?e.jsx(U,{size:14,onClick:P}):e.jsx($,{size:14,onClick:P}),value:m.new_password,onChange:l}),i>0&&e.jsx("p",{className:`text-sm ${i>=2?"text-green-500":"text-red-500"}`,children:i>=2?"Strong password":"Weak password"})]}),e.jsx(v,{type:o?"text":"password",title:"Confirm Password",placeholder:"",id:"confirm_password",icon:o?e.jsx(U,{size:14,onClick:C}):e.jsx($,{size:14,onClick:C}),value:m.confirm_password,onChange:l})]}),e.jsx("p",{className:"text-dark-blue text-sm",children:"Must be at least 8 characters long."})]})}),e.jsx("div",{className:" mt-5",children:e.jsx(N,{theme:xe,children:e.jsx(S,{variant:"contained",className:" w-full",color:"mainColor",type:"submit",disabled:w&&!0,children:"Update Password"})})})]})})})},{palette:pe}=y(),{augmentColor:he}=pe,ge=t=>he({color:{main:t}}),O=y({palette:{mainColor:ge("#ff5252")}}),J=()=>{const t=z(),[n,x]=r.useState("");r.useEffect(()=>{const s=JSON.parse(localStorage.getItem("user"));x(s.role),console.log(s.role)});const f=async()=>{c.fire({title:"Are you sure?",text:"You will not be able to recover your account!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, keep it"}).then(async s=>{if(s.isConfirmed)try{await p.delete("users/delete-account"),c.fire("Deleted!","Your account has been deleted.","success"),t("/auth/sign_up")}catch(w){console.error("Error:",w),c.fire("Error","Failed to delete user","error")}})},o=async()=>{try{const s=await p.post("company/switch-account-type");c.fire("","Your account has been successfully switched","success"),t("/auth/login")}catch(s){console.log(s),c.fire("Error","Failed to switch account","error")}};return e.jsxs("div",{className:" flex flex-col w-full px-3 items-center overflow-y-auto",children:[e.jsx("div",{className:"bg-white py-10 px-6 max-sm:px-3 flex flex-col justify-center mt-10 mb-10 rounded-2xl items-start gap-10 w-[75%] max-md:w-full",children:e.jsx("div",{className:" w-full ",children:e.jsxs("div",{className:" flex flex-col gap-5 pb-8 max-sm:flex-col",children:[e.jsxs("div",{className:" flex flex-col gap-5",children:[e.jsx("h1",{className:"font-bold text-3xl text-green-500",children:"Switch account type"}),e.jsxs("p",{className:"text-dark-blue text-base font-semibold",children:["By clicking the button below, you are switching your account type to ",n==="Company"?"User":"Company",". Are you sure you want to proceed?"]})]}),e.jsx("div",{className:" mt-5 flex justify-center",children:e.jsx(N,{theme:O,children:e.jsx(S,{variant:"contained",className:" w-[80%] max-md:w-full",color:"success",type:"button",onClick:()=>o(),children:"Switch account"})})})]})})}),e.jsx("div",{className:"bg-white py-10 px-6 max-sm:px-3 flex flex-col justify-center mt-10 mb-10 rounded-2xl items-start gap-10 w-[75%] max-md:w-full",children:e.jsx("div",{className:" w-full ",children:e.jsxs("div",{className:" flex flex-col gap-5 pb-8 max-sm:flex-col",children:[e.jsxs("div",{className:" flex flex-col gap-5",children:[e.jsx("h1",{className:"font-bold text-3xl text-red-500",children:"Delete Account"}),e.jsx("p",{className:"text-dark-blue text-base font-semibold",children:"By clicking the button below, you will permanently delete your account. Are you sure you want to proceed?"})]}),e.jsx("div",{className:" mt-5 flex justify-center",children:e.jsx(N,{theme:O,children:e.jsx(S,{variant:"contained",className:" w-[80%] max-md:w-full",color:"mainColor",type:"button",onClick:()=>f(),children:"Delete Account"})})})]})})})]})},Y=()=>{const[t,n]=r.useState([]),[x,f]=r.useState(null),[o,s]=r.useState({email:"",permission:""}),[w,h]=r.useState(!1);r.useEffect(()=>{(async()=>{try{const l=await p.get("company/all-staffs");n(l.data.data)}catch(l){console.error("Error fetching staff list:",l)}})()},[]);const m=async a=>{try{console.log(a);const l=await p.delete(`company/delete-staff/${a}`);console.log(l),n(j=>j.filter(b=>b.id!==a))}catch(l){console.error("Error deleting staff:",l)}},d=a=>{f(a),s({email:a.email,permission:a.permission}),h(!0)},i=()=>{h(!1),s({email:"",permission:""})},u=async a=>{a.preventDefault();try{const l={...o,id:x.id},j=await p.put("company/update-staff",l);console.log("Staff updated successfully:",j.data);const b=await p.get("company/all-staffs");n(b.data.data),f(null),s({email:"",permission:""}),h(!1)}catch(l){console.error("Error updating staff:",l)}},g=async a=>{a.preventDefault();try{const l=await p.post("company/add-staff",o);console.log("Staff added successfully:",l.data);const j=await p.get("company/all-staffs");n(j.data.data),s({email:"",permission:""})}catch(l){console.error("Error adding staff:",l)}};return e.jsxs("div",{className:"flex flex-col w-full px-3 items-center overflow-y-auto",children:[e.jsxs("div",{className:"bg-white py-10 px-6 max-sm:px-3 flex flex-col justify-center mt-10 mb-10 rounded-2xl items-start gap-10 w-[75%] max-md:w-full",children:[e.jsxs("div",{className:"w-full",children:[e.jsx("h1",{className:"font-bold text-3xl",children:"Add Staff"}),e.jsxs("form",{onSubmit:g,children:[e.jsxs("div",{className:"flex gap-2 mb-2 mt-5",children:[e.jsx(v,{type:"text",title:"Staff Email",placeholder:"Enter staff email",name:"email",value:o.email,onChange:a=>s({...o,email:a.target.value})}),e.jsxs("select",{className:"rounded-md border py-2.5 pl-2 text-dark-blue shadow-sm placeholder:text-gray-400 focus:outline-none focus:border focus:border-mansa-blue sm:text-sm sm:leading-6 hover:border-mansa-blue",name:"permission",value:o.permission,required:!0,onChange:a=>s({...o,permission:a.target.value}),children:[e.jsx("option",{value:"",children:"Select permission"}),e.jsx("option",{value:"Viewer",children:"Viewer"}),e.jsx("option",{value:"Editor",children:"Editor"})]})]}),e.jsx(I,{text:"Add Staff",type:"submit"})]})]}),e.jsx("h2",{className:"font-bold text-3xl mt-5",children:"All Staffs"}),e.jsxs("table",{className:"w-full border-collapse border border-gray-300 text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200",children:[e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Email"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Permission"}),e.jsx("th",{className:"border border-gray-300 px-4 py-2",children:"Actions"})]})}),e.jsx("tbody",{children:t.map(a=>e.jsxs("tr",{className:"hover:bg-gray-100",children:[e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:a.email}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:a.permission}),e.jsx("td",{className:"border border-gray-300 px-4 py-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>d(a),className:"bg-blue-500 text-white px-3 py-1 rounded",children:"Edit"}),e.jsx("button",{onClick:()=>m(a.id),className:"bg-red-500 text-white px-3 py-1 rounded",children:"Delete"})]})})]},a.id))})]})]}),w&&e.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-gray-800 bg-opacity-50 flex justify-center items-center",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-96",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Edit Staff"}),e.jsxs("form",{onSubmit:u,children:[e.jsx(v,{type:"text",title:"Email",value:o.email,onChange:a=>s({...o,email:a.target.value})}),e.jsxs("select",{className:"w-full mt-3 mb-4 rounded-md border py-2.5 pl-2",name:"permission",value:o.permission,onChange:a=>s({...o,permission:a.target.value}),children:[e.jsx("option",{value:"",children:"Select permission"}),e.jsx("option",{value:"Viewer",children:"Viewer"}),e.jsx("option",{value:"Editor",children:"Editor"})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx(I,{text:"Cancel",onClick:i}),e.jsx(I,{text:"Save",type:"submit"})]})]})]})})]})},we=()=>{const[t,n]=r.useState("Profile"),[x,f]=r.useState("");r.useEffect(()=>{const s=JSON.parse(localStorage.getItem("user"));f(s.role),console.log(s.role)});const o=()=>{switch(t){case"Profile":return e.jsx(V,{});case"Email":return e.jsx(F,{});case"Password":return e.jsx(B,{});case"Account":return e.jsx(J,{});case"Admin":return e.jsx(Y,{});default:return e.jsx(V,{})}};return e.jsxs("div",{className:"",children:[e.jsx("div",{className:"hidden sm:block",children:e.jsxs(_,{"aria-label":"Full width tabs",style:"fullWidth",className:"bg-light-grey",children:[e.jsx(_.Item,{active:t==="Profile",title:"Profile",icon:G,onClick:()=>n("Profile"),children:e.jsx(V,{})}),e.jsx(_.Item,{active:t==="Email",title:"Email",icon:W,onClick:()=>n("Email"),children:e.jsx(F,{})}),e.jsx(_.Item,{active:t==="Password",title:"Password",icon:K,onClick:()=>n("Password"),children:e.jsx(B,{})}),x==="Company"?e.jsx(_.Item,{active:t==="Admin",title:"Admin",onClick:()=>n("Admin"),children:e.jsx(Y,{})}):null,e.jsx(_.Item,{active:t==="Account",title:"Account",onClick:()=>n("Account"),children:e.jsx(J,{})})]})}),e.jsxs("div",{className:"block sm:hidden",children:[e.jsxs("select",{value:t,onChange:s=>n(s.target.value),className:"w-full text-lg px-3 py-4 border border-gray-300 active:outline-white",children:[e.jsx("option",{value:"Profile",children:"Profile Settings"}),e.jsx("option",{value:"Email",children:"Email Settings"}),e.jsx("option",{value:"Password",children:"Password Settings"}),e.jsx("option",{value:"Account",children:"Account Settings"})]}),e.jsx("div",{className:"mt-4",children:o()})]})]})};function ke(){const t=z(),{isAuthenticated:n}=M();return r.useEffect(()=>{n||t("/auth/login")},[n,t]),e.jsxs("div",{className:"",children:[e.jsx("div",{className:" sticky top-0 z-50",children:e.jsx(q,{})}),e.jsx(we,{})]})}export{ke as default};
